## 背景

代码的开发，镜像构建都是国外，国内拉取镜像较慢，6Gb的镜像有时候需要2-3个小时，严重影响到部署与测试。

## 方案整理

### 方案一

国内搭建私有仓库、通过拉取代码，国内构建实现加速

#### 优缺点

优点： 镜像存储在本地、同区域拉取较快

缺点：实现时间长、需要调整cicd、在拉取代码环节可能会很慢

### 方案二

通过oss共享镜像实现加速

#### 优缺点

优点： 改造成本低，可行性高

缺点： 需要在国内外部署两套私有仓库、使用oss存储加速

### 方案三

使用阿里云的镜像仓库

#### 优缺点

优点： 改造成本低，只需修改推送镜像仓库地址、实施时间短

缺点： 费用较高

## 方案选择

综合考虑，方案二的可行性高，实施周期短、费用低

## 实现原理

通过oss共享存储docker镜像，国外使用加速域名，提高传输速率，来达到镜像加速的目的

## 实施方案

1、申请一个国内oss存储，使用oss存储docker镜像

2、开启传输加速域名

3、国内通过registry部署私有镜像仓库、配置使用外网域名

4、国外通过registry部署私有镜像仓库、配置使用传输加速域名

5、域名解析，测试推送与拉取

## 解决问题

通过测试，发现推送6GB镜像需要12分钟左右、拉取需要10分钟左右，解决了国内拉取镜像慢的问题